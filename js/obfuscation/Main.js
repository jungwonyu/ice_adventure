(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e,t){e.on("pointerover",function(){"startButton"!==e.texture.key&&"howToPlayButton"!==e.texture.key||e.setTexture(e.texture.key+"Hover"),e.setScale(1.1*e.scaleX),t.game.canvas.style.cursor="pointer"}),e.on("pointerout",function(){"startButtonHover"!==e.texture.key&&"howToPlayButtonHover"!==e.texture.key||e.setTexture(e.texture.key.replace("Hover","")),e.setScale(e.scaleX/1.1),t.game.canvas.style.cursor="default"})}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function a(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function o(e,t,s){return(t=r(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function r(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}e.d({},{U:()=>R,f:()=>j});var n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.isMuted=!1,this.muteButton=null,this.soundButton=null,this.bgm=null}return s=e,r=[{key:"createSoundButtons",value:function(){var e=this,s=this.scene.scale,i=s.width,a=s.height;return this.muteButton=this.scene.add.image(i-70,a-60,"muteButton").setVisible(!this.isMuted).setScale(.2).setDepth(1e3).setInteractive(),t(this.muteButton,this.scene),this.muteButton.on("pointerdown",function(){return e.toggleMute()}),this.soundButton=this.scene.add.image(i-70,a-60,"soundButton").setVisible(this.isMuted).setScale(.2).setDepth(1e3).setInteractive(),t(this.soundButton,this.scene),this.soundButton.on("pointerdown",function(){return e.toggleMute()}),{muteButton:this.muteButton,soundButton:this.soundButton}}},{key:"toggleMute",value:function(){this.isMuted=!this.isMuted,this.muteButton.setVisible(!this.isMuted),this.soundButton.setVisible(this.isMuted),this.isMuted?(this.scene.sound.setMute(!0),this.bgm&&this.bgm.isPlaying&&this.bgm.pause()):(this.scene.sound.setMute(!1),this.bgm&&this.bgm.isPaused?this.bgm.resume():this.bgm&&!this.bgm.isPlaying&&this.bgm.play()),!this.isMuted&&this.scene.buttonSound&&this.scene.buttonSound.play()}},{key:"setBGM",value:function(e){if(this.bgm){if(this.bgm.key===e)return void(this.bgm.isPlaying||this.isMuted||this.bgm.play());this.bgm.stop()}this.bgm=this.scene.sound.add(e,{loop:!0,volume:.5}),this.isMuted||this.bgm.play()}},{key:"playBGM",value:function(){this.bgm&&!this.isMuted&&this.bgm.play()}},{key:"stopBGM",value:function(){this.bgm&&this.bgm.stop()}},{key:"pauseBGM",value:function(){this.bgm&&this.bgm.isPlaying&&this.bgm.pause()}},{key:"playSound",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isMuted)return null;var s=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach(function(t){o(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({volume:1,loop:!1},t),a=this.scene.sound.add(e,s);return a.stop(),a.play(),a}}],n=[{key:"getInstance",value:function(t){return e.instance?e.instance.scene=t:e.instance=new e(t),e.instance}}],r&&a(s.prototype,r),n&&a(s,n),Object.defineProperty(s,"prototype",{writable:!1}),s;var s,r,n}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function h(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,u(i.key),i)}}function u(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var s=t.call(e,"string");if("object"!=l(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(c=function(){return!!e})()}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}o(n,"instance",null);var y=function(){function e(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(e,t,s){return t=d(t),function(e,t){if(t&&("object"==l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,c()?Reflect.construct(t,s||[],d(e).constructor):t.apply(e,s))}(this,e,["MenuScene"])).quizData=null,t.soundManager=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(e,Phaser.Scene),s=e,(i=[{key:"preload",value:function(){this.createLoadingBar(),this.loadAnimations(),this.loadImages(),this.loadSounds(),this.load.json("quizData","data/quizData.json")}},{key:"create",value:function(){this.setStartScene(),this.setSoundManager()}},{key:"loadImages",value:function(){this.load.image("startBackground","assets/images/startBackground.png"),this.load.image("background","assets/images/background.png"),this.load.image("gameTitle","assets/images/gameTitle.png"),this.load.image("finishBackground","assets/images/finishBackground.png"),this.load.image("player","assets/images/player.png"),this.load.image("playerHit","assets/images/playerHit.png"),this.load.image("playerBullet","assets/images/playerBullet.png"),this.load.spritesheet("playerDance","assets/images/playerDance.png",{frameWidth:160,frameHeight:260}),this.load.spritesheet("playerSad","assets/images/playerSad.png",{frameWidth:160,frameHeight:260}),this.load.spritesheet("playerRepair","assets/images/playerRepair.png",{frameWidth:240,frameHeight:260}),this.load.spritesheet("double","assets/images/double.png",{frameWidth:260,frameHeight:260}),this.load.spritesheet("shield","assets/images/shield.png",{frameWidth:260,frameHeight:260}),this.load.spritesheet("coin","assets/images/coin.png",{frameWidth:260,frameHeight:260}),this.load.image("walkie","assets/images/walkie.png"),this.load.image("repair","assets/images/repair.png"),this.load.spritesheet("distance","assets/images/distance.png",{frameWidth:256,frameHeight:130}),this.load.image("revivePopup","assets/images/revivePopup.png"),this.load.image("reviveButton","assets/images/reviveButton.png"),this.load.image("endGameButton","assets/images/endGameButton.png"),this.load.image("quizContainer","assets/images/quizContainer.png"),this.load.image("quizItemBox","assets/images/quizItemBox.png"),this.load.image("nextContainer","assets/images/nextContainer.png"),this.load.image("obstacle2","assets/images/obstacle2.png"),this.load.image("obstacle2Ice","assets/images/obstacle2Ice.png"),this.load.image("obstacle3","assets/images/obstacle3.png"),this.load.spritesheet("obstacle1","assets/images/obstacle1.png",{frameWidth:400,frameHeight:400}),this.load.image("boss1","assets/images/boss1.png"),this.load.image("boss2","assets/images/boss2.png"),this.load.image("boss3","assets/images/boss3.png"),this.load.image("boss4","assets/images/boss4.png"),this.load.image("boss5","assets/images/boss5.png"),this.load.image("bossBullet","assets/images/bossBullet.png"),this.load.image("playButton","assets/images/playButton.png"),this.load.image("pauseButton","assets/images/pauseButton.png"),this.load.image("soundButton","assets/images/soundButton.png"),this.load.image("muteButton","assets/images/muteButton.png"),this.load.image("startButton","assets/images/startButton.png"),this.load.image("startButtonHover","assets/images/startButtonHover.png"),this.load.image("howToPlayButton","assets/images/howToPlayButton.png"),this.load.image("howToPlayButtonHover","assets/images/howToPlayButtonHover.png"),this.load.image("goHomeButton","assets/images/goHomeButton.png"),this.load.image("guide1","assets/images/guide1.png"),this.load.image("guide2","assets/images/guide2.png"),this.load.image("guide3","assets/images/guide3.png"),this.load.image("guide4","assets/images/guide4.png"),this.load.image("guide5","assets/images/guide5.png"),this.load.image("leftArrow","assets/images/leftArrow.png"),this.load.image("rightArrow","assets/images/rightArrow.png"),this.load.image("closeButton","assets/images/closeButton.png")}},{key:"loadAnimations",value:function(){var e=this;this.load.on("complete",function(){[{key:"obstacle1Ani",spriteKey:"obstacle1",frames:{start:0,end:2},frameRate:3},{key:"coinAni",spriteKey:"coin",frames:{start:0,end:3},frameRate:10},{key:"shieldAni",spriteKey:"shield",frames:{start:0,end:3},frameRate:10},{key:"doubleAni",spriteKey:"double",frames:{start:0,end:3},frameRate:10},{key:"distanceAni",spriteKey:"distance",frames:{start:3,end:0},frameRate:3},{key:"playerDanceAni",spriteKey:"playerDance",frames:{start:0,end:4},frameRate:5},{key:"playerSadAni",spriteKey:"playerSad",frames:{start:0,end:4},frameRate:5},{key:"playerRepairAni",spriteKey:"playerRepair",frames:{start:0,end:4},frameRate:5}].forEach(function(t){e.anims.exists(t.key)||e.anims.create({key:t.key,frames:e.anims.generateFrameNumbers(t.spriteKey,t.frames),frameRate:t.frameRate,repeat:-1})})})}},{key:"loadSounds",value:function(){this.load.audio("bgm","assets/sounds/bgm.mp3"),this.load.audio("bossBgm","assets/sounds/bossBgm.mp3"),this.load.audio("coinBgm","assets/sounds/coinBgm.mp3"),this.load.audio("nextBgm","assets/sounds/nextBgm.mp3"),this.load.audio("buttonSound","assets/sounds/button.mp3"),this.load.audio("coinSound","assets/sounds/coin.mp3"),this.load.audio("helperSound","assets/sounds/helper.mp3"),this.load.audio("bulletHitSound","assets/sounds/bulletHit.mp3"),this.load.audio("explosionSound","assets/sounds/explosion.mp3"),this.load.audio("bossShootSound","assets/sounds/bossShoot.mp3"),this.load.audio("correctSound","assets/sounds/correct.mp3"),this.load.audio("incorrectSound","assets/sounds/incorrect.mp3"),this.load.audio("countdownSound","assets/sounds/countdown.mp3"),this.load.audio("nextLevelSound","assets/sounds/nextLevel.mp3"),this.load.audio("finalSound","assets/sounds/final.mp3"),this.load.audio("gameOverSound","assets/sounds/gameOver.mp3"),this.load.audio("hitPlayerSound","assets/sounds/hitPlayer.mp3")}},{key:"setStartScene",value:function(){var e=this,s=this.scale,i=s.width,a=s.height;this.add.image(i/2,a/2,"startBackground").setOrigin(.5).setDisplaySize(i,a);var o=this.add.image(i/2,a/2-400,"gameTitle").setOrigin(.5).setScale(0);this.tweens.add({targets:o,scaleX:.7,scaleY:.7,duration:1e3,ease:"Back.out"});var r=this.add.image(i/2-150,a/2-100,"startButton").setOrigin(.5).setScale(.3).setInteractive();t(r,this),r.on("pointerdown",function(){var t=e.cache.json.get("quizData");e.scene.stop("MenuScene"),e.scene.start("GameScene",{quizData:t}),e.soundManager.playSound("buttonSound")});var n=this.add.image(i/2+150,a/2-100,"howToPlayButton").setOrigin(.5).setScale(.3).setInteractive();t(n,this),n.on("pointerdown",function(){return e.showHowToPlayPopup()})}},{key:"setSoundManager",value:function(){this.soundManager=n.getInstance(this),this.soundManager.createSoundButtons(),this.soundManager.setBGM("bgm")}},{key:"createLoadingBar",value:function(){var e=this.scale,t=e.width,s=e.height;this.cameras.main.setBackgroundColor(13234170);var i={background:{x:t/2-250,y:s/2-40,width:500,height:80,radius:25},progressBg:{x:t/2-240,y:s/2-30,width:480,height:60,radius:20},progress:{x:t/2-240,y:s/2-30,height:60,radius:20}},a=this.add.graphics();a.fillStyle(0,.7),a.fillRoundedRect(i.background.x,i.background.y,i.background.width,i.background.height,i.background.radius),a.setDepth(10);var o=this.add.graphics();o.fillStyle(3355443,.8),o.fillRoundedRect(i.progressBg.x,i.progressBg.y,i.progressBg.width,i.progressBg.height,i.progressBg.radius),o.setDepth(11);var r=this.add.graphics();r.setDepth(12),this.load.on("progress",function(e){r.clear(),r.fillStyle(R.hex_lollipop,1);var t=i.progressBg.width*e;r.fillRoundedRect(i.progress.x,i.progress.y,t,i.progress.height,i.progress.radius)}),this.load.on("complete",function(){return[a,o,r].forEach(function(e){return e.destroy()})})}},{key:"showHowToPlayPopup",value:function(){this.soundManager.playSound("buttonSound");var e=this.scale,t=e.width,s=e.height,i=this.createPopupElements(t,s,1);this.setupPopupEvents(i,1),this.animatePopupEntrance(i)}},{key:"createPopupElements",value:function(e,s,i){var a=this.add.rectangle(e/2,s/2,e,s,0,.7).setDepth(100).setInteractive(),o=this.add.image(e/2,s/2,"guide1").setOrigin(.5).setDepth(101).setScale(.8),r=this.add.image(e/2-300,s/2,"leftArrow").setOrigin(.5).setDepth(102).setScale(.2).setInteractive();t(r,this);var n=this.add.image(e/2+300,s/2,"rightArrow").setOrigin(.5).setDepth(102).setScale(.2).setInteractive();t(n,this);var l=this.add.text(e/2,s/2+400,"".concat(i,"/5"),{fontSize:"28px",fill:R.color_deepBlue,fontFamily:"Cafe24Surround",stroke:R.color_snow,strokeThickness:3,backgroundColor:"#ffffff"}).setOrigin(.5).setDepth(102),h=this.add.image(e/2,s-150,"closeButton").setOrigin(.5).setDepth(102).setScale(.3).setInteractive();return t(h,this),{overlay:a,guideImage:o,leftArrow:r,rightArrow:n,pageIndicator:l,closeButton:h}}},{key:"setupPopupEvents",value:function(e,t){var s=this,i=e.overlay,a=e.guideImage,o=e.leftArrow,r=e.rightArrow,n=e.pageIndicator,l=e.closeButton,h=function(){a.setTexture("guide".concat(t)),n.setText("".concat(t,"/5"))};o.on("pointerdown",function(){s.soundManager.playSound("buttonSound"),--t<1&&(t=5),h()}),r.on("pointerdown",function(){s.soundManager.playSound("buttonSound"),++t>5&&(t=1),h()});var u=function(){s.soundManager.playSound("buttonSound"),Object.values(e).forEach(function(e){return e.destroy()}),s.game.canvas.style.cursor="default"};l.on("pointerdown",u),i.on("pointerdown",u)}},{key:"animatePopupEntrance",value:function(e){var t=e.guideImage,s=e.leftArrow,i=e.rightArrow,a=e.pageIndicator,o=e.closeButton;t.setScale(0),[s,i,a,o].forEach(function(e){return e.setAlpha(0)}),this.tweens.add({targets:t,scaleX:.8,scaleY:.8,duration:300,ease:"Back.out"}),this.tweens.add({targets:[s,i,a,o],alpha:1,duration:300,ease:"Power2.out",delay:150})}}])&&h(s.prototype,i),Object.defineProperty(s,"prototype",{writable:!1}),s;var s,i}();function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function b(){var e,t,s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",a=s.toStringTag||"@@toStringTag";function o(s,i,a,o){var l=i&&i.prototype instanceof n?i:n,h=Object.create(l.prototype);return f(h,"_invoke",function(s,i,a){var o,n,l,h=0,u=a||[],c=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,s){return o=t,n=0,l=e,d.n=s,r}};function p(s,i){for(n=s,l=i,t=0;!c&&h&&!a&&t<u.length;t++){var a,o=u[t],p=d.p,y=o[2];s>3?(a=y===i)&&(l=o[(n=o[4])?5:(n=3,3)],o[4]=o[5]=e):o[0]<=p&&((a=s<2&&p<o[1])?(n=0,d.v=i,d.n=o[1]):p<y&&(a=s<3||o[0]>i||i>y)&&(o[4]=s,o[5]=i,d.n=y,n=0))}if(a||s>1)return r;throw c=!0,i}return function(a,u,y){if(h>1)throw TypeError("Generator is already running");for(c&&1===u&&p(u,y),n=u,l=y;(t=n<2?e:l)||!c;){o||(n?n<3?(n>1&&(d.n=-1),p(n,l)):d.n=l:d.v=l);try{if(h=2,o){if(n||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,n<2&&(n=0)}else 1===n&&(t=o.return)&&t.call(o),n<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),n=1);o=e}else if((t=(c=d.n<0)?l:s.call(i,d))!==r)break}catch(t){o=e,n=1,l=t}finally{h=1}}return{value:t,done:c}}}(s,a,o),!0),h}var r={};function n(){}function l(){}function h(){}t=Object.getPrototypeOf;var u=[][i]?t(t([][i]())):(f(t={},i,function(){return this}),t),c=h.prototype=n.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,f(e,a,"GeneratorFunction")),e.prototype=Object.create(c),e}return l.prototype=h,f(c,"constructor",h),f(h,"constructor",l),l.displayName="GeneratorFunction",f(h,a,"GeneratorFunction"),f(c),f(c,a,"Generator"),f(c,i,function(){return this}),f(c,"toString",function(){return"[object Generator]"}),(b=function(){return{w:o,m:d}})()}function f(e,t,s,i){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}f=function(e,t,s,i){function o(t,s){f(e,t,function(e){return this._invoke(t,s,e)})}t?a?a(e,t,{value:s,enumerable:!i,configurable:!i,writable:!i}):e[t]=s:(o("next",0),o("throw",1),o("return",2))},f(e,t,s,i)}function m(e,t,s,i,a,o,r){try{var n=e[o](r),l=n.value}catch(e){return void s(e)}n.done?t(l):Promise.resolve(l).then(i,a)}function v(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,B(i.key),i)}}function B(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var s=t.call(e,"string");if("object"!=g(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(w=function(){return!!e})()}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}var x=function(){function e(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(e,t,s){return t=S(t),function(e,t){if(t&&("object"==g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,w()?Reflect.construct(t,s||[],S(e).constructor):t.apply(e,s))}(this,e,["GameScene"])).soundManager=null,t.player=null,t.obstacles=null,t.boss=null,t.bossBullets=null,t.bossBulletTimer=null,t.playerBullets=null,t.bulletTimer=null,t.doubleTimer=null,t.background=null,t.backgroundSpeed=426,t.obstacleSpeed=426,t.playerShake=0,t.score=0,t.scoreText=null,t.distance=0,t.distanceText=null,t.level=1,t.walkies=null,t.isGameOver=!1,t.isPaused=!1,t.isBossShown=!1,t.obstacleTimer=null,t.currentObstacleType=0,t.obstacleCount=0,t.maxObstacles=30,t.cursors=null,t.gameOverText=null,t.quizData=null,t.overlay=null,t.repairSprite=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(e,Phaser.Scene),s=e,i=[{key:"create",value:function(e){var t=this,s=this.scale,i=(s.width,s.height);this.quizData=(null==e?void 0:e.quizData)||[],this.soundManager=n.getInstance(this),this.soundManager.createSoundButtons(),this.background=this.add.tileSprite(360,640,720,1280,"background"),this.createButtons(),this.player=this.physics.add.sprite(360,1120,"player").setScale(.3),this.player.body.setSize(.8*this.player.width,.8*this.player.height),this.player.setCollideWorldBounds(!0),this.playerBullets=this.physics.add.group({defaultKey:"playerBullet"}),this.bossBullets=this.physics.add.group({defaultKey:"bossBullet"}),this.bulletTimer=this.time.addEvent({delay:500,callback:function(){if(!t.isGameOver){var e=t.playerBullets.get(t.player.x,t.player.y-50);e&&(e.setScale(.1),e.body.setVelocityY(-600))}},loop:!0}),this.obstacles=this.physics.add.group(),this.coins=this.physics.add.group(),this.shields=this.physics.add.group(),this.doubles=this.physics.add.group(),this.walkies=this.physics.add.group();var a=this.add.container(100,50);a.setDepth(20);var o=this.add.graphics();o.fillStyle(16777215,.6),o.fillRoundedRect(-70,-28,140,56,20);var r=this.add.sprite(-35,0,"coin");r.setScale(.2),r.play("coinAni"),this.scoreText=this.add.text(20,0,"0",{fontSize:"24px",fill:"#333",fontFamily:"Cafe24Surround"}).setOrigin(.5),a.add([o,r,this.scoreText]);var l=this.add.container(100,120);l.setDepth(20);var h=this.add.graphics();h.fillStyle(16777215,.6),h.fillRoundedRect(-70,-28,140,56,20);var u=this.add.sprite(-35,0,"distance");u.setScale(.2),u.play("distanceAni"),this.distanceText=this.add.text(25,0,"0m",{fontSize:"24px",fill:"#333",fontFamily:"Cafe24Surround"}).setOrigin(.5),l.add([h,u,this.distanceText]);var c=this.add.container(100,i-40);c.setDepth(20);var d=this.add.graphics();d.fillStyle(16777215,.6),d.fillRoundedRect(-70,-28,140,56,20),this.walkieText=this.add.text(20,0,"3",{fontSize:"24px",fill:"#333",fontFamily:"Cafe24Surround"}).setOrigin(.5);var p=this.add.image(-35,0,"walkie").setScale(.2);c.add([d,p,this.walkieText]);var y=this.add.container(260,i-40);y.setDepth(20);var g=this.add.graphics();g.fillStyle(16777215,.6),g.fillRoundedRect(-70,-28,140,56,20),this.repairText=this.add.text(20,0,"0",{fontSize:"24px",fill:"#333",fontFamily:"Cafe24Surround"}).setOrigin(.5);var b=this.add.image(-35,0,"repair").setScale(.15);y.add([g,b,this.repairText]),this.physics.add.overlap(this.player,this.obstacles,this.playerHitObstacle,null,this),this.physics.add.overlap(this.player,this.bossBullets,this.bossBulletHitPlayer,null,this),this.physics.add.overlap(this.playerBullets,this.obstacles,this.playerBulletHitObstacle,null,this),this.physics.add.overlap(this.player,this.coins,this.collectCoin,null,this),this.physics.add.overlap(this.player,this.shields,this.collectShield,null,this),this.physics.add.overlap(this.player,this.doubles,this.collectDouble,null,this),this.physics.add.overlap(this.player,this.walkies,this.collectWalkie,null,this),this.cursors=this.input.keyboard.createCursorKeys(),this.startObstacleTimer(),this.isGameOver=!1,this.createLevelProgressBar(),this.isDragging=!1,this.dragOffsetX=0,this.input.on("pointerdown",function(e){Phaser.Math.Distance.Between(e.x,e.y,t.player.x,t.player.y)<150&&(t.isDragging=!0,t.dragOffsetX=t.player.x-e.x)}),this.input.on("pointerup",function(){t.isDragging=!1}),this.input.on("pointermove",function(e){if(t.isDragging)if(t.isBossShown){var s=e.x+t.dragOffsetX,i=e.y;s=Math.max(150,Math.min(s,t.scale.width-150)),i=Math.max(150,Math.min(i,t.scale.height-150)),t.player.x=s,t.player.y=i}else{var a=e.x+t.dragOffsetX;a=Math.max(150,Math.min(a,t.scale.width-150)),t.player.x=a}})}},{key:"update",value:(a=b().m(function e(t,s){var i,a,o,r,n,l,h,u,c,d,p,y,g=this;return b().w(function(e){for(;;)switch(e.n){case 0:if(!this.isGameOver&&!this.isPaused){e.n=1;break}return e.a(2);case 1:if(i=s/1e3,this.isPaused||this.isGameOver||this.isBossShown||(this.background.tilePositionY-=this.backgroundSpeed*i),!this.isDragging){e.n=2;break}return this.player.setVelocityX(0),this.player&&this.player.shieldOverlay&&(this.player.shieldOverlay.x=this.player.x,this.player.shieldOverlay.y=this.player.y),this.doubleTimerBar&&this.player&&(a=this.player.x,o=this.player.y-80,this.doubleTimerBg&&(this.doubleTimerBg.x=a,this.doubleTimerBg.y=o),this.doubleTimerBarBg&&(this.doubleTimerBarBg.x=a,this.doubleTimerBarBg.y=o),this.doubleTimerBar.x=a,this.doubleTimerBar.y=o,this.updateDoubleTimerUI()),r=j[this.level].bossDistance/100,n=this.distance>=r,this.isBossShown||n||(l=s/1e3,this.distance+=l,this.distanceText.setText("".concat(Math.floor(this.distance),"m"))),this.boss&&this.boss.active&&this.updateBossHealthUI(),this.obstacles.children.entries.forEach(function(e){if("obstacle1"===e.texture.key){if(e.isHit)return;var t=e.x+8*Math.sin(Date.now()/2e3+e.y/100),s=e.width*e.scaleX*.5;t>=150+s&&t<=g.scale.width-150-s&&e.setX(t)}}),e.a(2);case 2:if(h=j[this.level].bossDistance/100,u=this.distance>=h,!(this.obstacleCount>=this.maxObstacles&&0==this.obstacles.children.entries.length&&u)||this.isGameOver||this.isBossShown){e.n=3;break}for(this.isBossShown=!0,c=.3*this.scale.height,d=this.add.graphics({x:0,y:0}).setDepth(100),p=0;p<c;p+=4)y=.7*(1-p/c),d.fillStyle(16711680,y),d.fillRect(0,p,this.scale.width,4);return this.tweens.add({targets:d,alpha:.2,duration:300,yoyo:!0,repeat:7}),this.time.delayedCall(2e3,function(){d.destroy(),g.showBoss()}),e.a(2);case 3:this.boss&&this.boss.active&&(this.boss.y<245||(this.boss.y=250,this.boss.setVelocityY(0))),this.isBossShown?(this.cursors.left.isDown&&this.player.x>150?this.player.setVelocityX(-540):this.cursors.right.isDown&&this.player.x<this.scale.width-150?this.player.setVelocityX(540):this.player.setVelocityX(0),this.cursors.up.isDown&&this.player.y>150?this.player.setVelocityY(-540):this.cursors.down.isDown&&this.player.y<this.scale.height-150?this.player.setVelocityY(540):this.player.setVelocityY(0)):this.cursors.left.isDown&&this.player.x>150?this.player.setVelocityX(-540):this.cursors.right.isDown&&this.player.x<this.scale.width-150?this.player.setVelocityX(540):(this.player.setVelocityX(0),this.playerShake=3),this.player&&this.player.shieldOverlay&&(this.player.shieldOverlay.x=this.player.x,this.player.shieldOverlay.y=this.player.y),this.playerShake>0&&(this.player.y+=2*Math.sin(Date.now()/40)),this.isBossShown||u||(this.distance+=i,this.distanceText.setText("".concat(Math.floor(this.distance),"m"))),this.playerBullets.children.entries.forEach(function(e){return e.y<-50&&e.destroy()}),this.bossBullets.children.entries.forEach(function(e){return e.y>1330&&e.destroy()}),this.coins.children.entries.forEach(function(e){return e.y>1330&&e.destroy()}),this.shields.children.entries.forEach(function(e){return e.y>1330&&e.destroy()}),this.obstacles.children.entries.forEach(function(e){if(e.y>1330&&e.destroy(),"obstacle1"===e.texture.key){if(e.isHit)return;var t=e.x+8*Math.sin(Date.now()/2e3+e.y/100),s=e.width*e.scaleX*.5;t>=150+s&&t<=g.scale.width-150-s&&e.setX(t)}}),this.updateDoubleTimerUI(),this.boss&&this.boss.active&&this.updateBossHealthUI();case 4:return e.a(2)}},e,this)}),o=function(){var e=this,t=arguments;return new Promise(function(s,i){var o=a.apply(e,t);function r(e){m(o,s,i,r,n,"next",e)}function n(e){m(o,s,i,r,n,"throw",e)}r(void 0)})},function(e,t){return o.apply(this,arguments)})},{key:"createLevelProgressBar",value:function(){var e=this.scale.width,t=(e-350)/2;this.levelBarBg=this.add.graphics(),this.levelBarBg.fillStyle(16777215,.8),this.levelBarBg.fillRoundedRect(t,24,350,30,12),this.levelBarBg.setDepth(30),this.levelBar=this.add.graphics(),this.levelBar.setDepth(31),this.updateLevelProgressBar(),this.levelBarText=this.add.text(e/2,39,"Level ".concat(this.level," / 10"),{fontSize:"20px",fill:"#333",fontFamily:"Cafe24Surround"}).setOrigin(.5).setDepth(32)}},{key:"updateLevelProgressBar",value:function(){if(this.levelBar){var e=(this.scale.width-350)/2,t=Math.min(this.level,10)/10;this.levelBar.clear(),this.levelBar.fillStyle(R.hex_mint,1),this.levelBar.fillRoundedRect(e,24,350*t,30,12),this.levelBarText&&this.levelBarText.setText("Level ".concat(this.level," / 10"))}}},{key:"createButtons",value:function(){var e=this,s=this.scale.width;this.playButton=this.add.image(s-50,50,"playButton").setScale(.2).setDepth(40).setVisible(!1).setInteractive(),t(this.playButton,this),this.playButton.on("pointerdown",function(){e.soundManager.playSound("buttonSound"),e.playButton.setVisible(!1),e.pauseButton.setVisible(!0),e.gameResume()}),this.pauseButton=this.add.image(s-50,50,"pauseButton").setScale(.2).setDepth(40).setVisible(!0).setInteractive(),t(this.pauseButton,this),this.pauseButton.on("pointerdown",function(){e.soundManager.playSound("buttonSound"),e.pauseButton.setVisible(!1),e.playButton.setVisible(!0),e.gamePause()})}},{key:"gamePause",value:function(){this.isPaused=!0,this.physics.pause(),this.sound.pauseAll(),this.children.list.forEach(function(e){e.anims&&e.anims.currentAnim&&"playerDanceAni"!==e.anims.currentAnim.key&&e.anims.pause()}),this.coins.children.entries.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.pause()}),this.shields.children.entries.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.pause()}),this.doubles.children.entries.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.pause()}),this.obstacles.children.entries.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.pause()}),this.bulletTimer&&(this.bulletTimer.paused=!0),this.obstacleTimer&&(this.obstacleTimer.paused=!0),this.doubleTimer&&(this.doubleTimer.paused=!0),this.bossBulletTimer&&(this.bossBulletTimer.paused=!0)}},{key:"gameResume",value:function(){this.isPaused=!1,this.physics.resume(),this.sound.resumeAll(),this.children.list.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.isPaused&&"playerDanceAni"!==e.anims.currentAnim.key&&e.anims.resume()}),this.coins.children.entries.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.resume()}),this.shields.children.entries.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.resume()}),this.doubles.children.entries.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.resume()}),this.obstacles.children.entries.forEach(function(e){e.anims&&e.anims.currentAnim&&e.anims.resume()}),this.bulletTimer&&(this.bulletTimer.paused=!1),this.obstacleTimer&&(this.obstacleTimer.paused=!1),this.doubleTimer&&(this.doubleTimer.paused=!1),this.bossBulletTimer&&(this.bossBulletTimer.paused=!1)}},{key:"createObstacle",value:function(){if(this.isGameOver||this.isPaused||this.obstacleCount>=this.maxObstacles)this.obstacleCount>=this.maxObstacles&&this.obstacleTimer&&(this.obstacleTimer.destroy(),this.obstacleTimer=null);else{this.currentObstacleType=(this.currentObstacleType+1)%3;var e="obstacle"+(this.currentObstacleType+1),t={obstacle1:{scale:.3,margin:150},obstacle2:{scale:.3,margin:150},obstacle3:{scale:.4,margin:200}}[e];if("obstacle1"===e){for(var s=j[this.level].obstacleCount,i=(720-220*(s-1))/2,a=0;a<s;a++){var o=i+220*a;o=Math.max(t.margin,Math.min(o,720-t.margin));var r=this.obstacles.create(o,-100,e);r.originalType=e,r.setScale(t.scale),r.play("obstacle1Ani"),r.setSize(.8*r.width,.8*r.height),r.setVelocityY(this.obstacleSpeed)}this.obstacleCount++}else{var n=Phaser.Math.Between(t.margin,720-t.margin),l=this.obstacles.create(n,-100,e);this.obstacleCount++,l.originalType=e,l.setScale(t.scale),l.setSize(.8*l.width,.8*l.height),l.setVelocityY(this.obstacleSpeed)}}}},{key:"createOverlay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:45;this.overlay&&this.overlay.destroy();var t=this.scale,s=t.width,i=t.height;return this.overlay=this.add.rectangle(s/2,i/2,s,i,0,0).setDepth(e).setInteractive(),this.overlay}},{key:"removeOverlay",value:function(){this.overlay&&(this.overlay.destroy(),this.overlay=null)}},{key:"handlePlayerHit",value:function(e,t){if(!this.isGameOver){if(e.shieldOverlay)return e.shieldOverlay.destroy(),e.shieldOverlay=null,void(t&&t.destroy?t.destroy():e.y+=400);t&&t.destroy(),e.setTexture("playerHit"),this.obstacleTimer&&(this.obstacleTimer.remove(),this.obstacleTimer=null),this.gamePause(),this.showRevivePopup()}}},{key:"playerHitObstacle",value:function(e,t){this.isGameOver||this.handlePlayerHit(e,t)}},{key:"bossBulletHitPlayer",value:function(e,t){this.isGameOver||this.handlePlayerHit(e,t)}},{key:"bossHitPlayer",value:function(e,t){this.isGameOver||this.handlePlayerHit(e,null)}},{key:"playerBulletHitObstacle",value:function(e,t){this.soundManager.playSound("bulletHitSound"),e.destroy(),t.hitCount=t.hitCount||0,t.hitCount+=1;var s=this.add.text(t.x,t.y-30,"Hit ".concat(t.hitCount),{fontFamily:"Cafe24Surround",fontSize:"20px",fontStyle:"bold",fill:R.color_lollipop,stroke:R.color_snow,strokeThickness:4});switch(this.time.delayedCall(500,function(){return s.destroy()}),t.originalType){case"obstacle1":if(1===t.hitCount)t.isHit=!0;else{var i,a=0===Phaser.Math.Between(0,1)?"double":"shield";(i="double"===a?this.doubles.create(t.x,t.y,"double"):this.shields.create(t.x,t.y,"shield")).setScale(.3),i.setSize(.8*i.width,.8*i.height),i.play(a+"Ani"),i.body.setVelocityY(this.obstacleSpeed),t.destroy()}break;case"obstacle2":if(1===t.hitCount)t.setTexture("obstacle2Ice");else{var o=this.coins.create(t.x,t.y,"coin");o.setScale(.3),o.setSize(.8*o.width,.8*o.height),o.play("coinAni"),o.body.setVelocityY(this.obstacleSpeed),t.destroy()}break;case"obstacle3":if(1===t.hitCount)t.setScale(.8*t.scaleX),t.setSize(.8*t.width,.8*t.height);else{for(var r=-1;r<=1;r+=2){var n=this.coins.create(t.x+20*r,t.y,"coin");n.setScale(.3),n.setSize(.8*n.width,.8*n.height),n.play("coinAni"),n.body.setVelocityY(this.obstacleSpeed)}t.destroy()}}}},{key:"playerBulletHitBoss",value:function(e,t){switch(this.soundManager.playSound("bulletHitSound"),t.destroy(),e.hitCount+=1,this.updateBossHealthUI(),e.hitCount){case 1:e.setTexture("boss2");break;case j[this.level].bossHit/4:e.setTexture("boss3");break;case j[this.level].bossHit/2:e.setTexture("boss4");break;case j[this.level].bossHit:e.setTexture("boss5"),this.defeatBoss(e)}}},{key:"collectCoin",value:function(e,t){this.soundManager.playSound("coinSound"),t.destroy(),this.score+=10,this.scoreText.setText(this.score);var s=this.add.text(t.x,t.y-30,"+10",{fontFamily:"Cafe24Surround",fontSize:"20px",fontStyle:"bold",fill:R.color_lollipop,stroke:R.color_snow,strokeThickness:4});this.tweens.add({targets:s,y:s.y-50,alpha:0,duration:800,onComplete:function(){return s.destroy()}})}},{key:"collectShield",value:function(e,t){this.soundManager.playSound("helperSound"),t.destroy(),e.shieldOverlay&&(e.shieldOverlay.destroy(),e.shieldOverlay=null);var s=this.add.graphics();s.fillStyle(6737151,.3),s.fillCircle(0,0,.2*e.width),s.setDepth(1),s.x=e.x,s.y=e.y,e.shieldOverlay=s}},{key:"collectDouble",value:function(e,t){var s=this;this.soundManager.playSound("helperSound"),t.destroy(),this.doubleTimer&&this.doubleTimer.destroy(),this.bulletTimer&&this.bulletTimer.destroy(),this.createDoubleTimerUI(),this.bulletTimer=this.time.addEvent({delay:500,callback:function(){if(!s.isGameOver){var e=s.playerBullets.get(s.player.x-25,s.player.y-50);e&&(e.setScale(.1),e.body.setVelocityY(-600));var t=s.playerBullets.get(s.player.x+25,s.player.y-50);t&&(t.setScale(.1),t.body.setVelocityY(-600))}},loop:!0}),this.doubleTimer=this.time.delayedCall(1e4,function(){s.bulletTimer&&s.bulletTimer.destroy(),s.removeDoubleTimerUI(),s.bulletTimer=s.time.addEvent({delay:500,callback:function(){if(!s.isGameOver){var e=s.playerBullets.get(s.player.x,s.player.y-50);e&&(e.setScale(.1),e.body.setVelocityY(-600))}},loop:!0}),s.doubleTimer=null})}},{key:"collectWalkie",value:function(e,t){t.destroy();var s=parseInt(this.walkieText.text);this.walkieText.setText(s+1)}},{key:"updateDoubleTimerUI",value:function(){if(this.doubleTimerBar&&this.player){var e=this.time.now-this.doubleStartTime,t=Math.max(0,this.doubleDuration-e)/this.doubleDuration,s=this.player.x,i=this.player.y-80;this.doubleTimerBg.x=s,this.doubleTimerBg.y=i,this.doubleTimerBarBg.x=s,this.doubleTimerBarBg.y=i,this.doubleTimerBar.x=s,this.doubleTimerBar.y=i,this.doubleTimerBar.clear();var a=R.hex_greenTea;t<.3?a=R.hex_lollipop:t<.6&&(a=R.hex_candy),this.doubleTimerBar.fillStyle(a,1);var o=90*t;this.doubleTimerBar.fillRoundedRect(-45,-25,o,10,5)}}},{key:"createDoubleTimerUI",value:function(){this.removeDoubleTimerUI(),this.doubleTimerBg=this.add.graphics(),this.doubleTimerBg.fillStyle(R.hex_black,.7),this.doubleTimerBg.fillRoundedRect(-50,-30,100,20,10),this.doubleTimerBg.setDepth(10),this.doubleTimerBarBg=this.add.graphics(),this.doubleTimerBarBg.fillStyle(3355443,.8),this.doubleTimerBarBg.fillRoundedRect(-45,-25,90,10,5),this.doubleTimerBarBg.setDepth(11),this.doubleTimerBar=this.add.graphics(),this.doubleTimerBar.setDepth(12),this.doubleStartTime=this.time.now,this.doubleDuration=1e4}},{key:"removeDoubleTimerUI",value:function(){this.doubleTimerBg&&(this.doubleTimerBg.destroy(),this.doubleTimerBg=null),this.doubleTimerBarBg&&(this.doubleTimerBarBg.destroy(),this.doubleTimerBarBg=null),this.doubleTimerBar&&(this.doubleTimerBar.destroy(),this.doubleTimerBar=null)}},{key:"updateBossHealthUI",value:function(){if(this.bossHealthBar&&this.boss){var e=j[this.level].bossHit,t=Math.max(0,e-this.boss.hitCount)/e,s=this.boss.x,i=this.boss.y-160;this.bossHealthBg.x=s,this.bossHealthBg.y=i,this.bossHealthBarBg.x=s,this.bossHealthBarBg.y=i,this.bossHealthBar.x=s,this.bossHealthBar.y=i,this.bossHealthBar.clear();var a=R.hex_greenTea;t<.3?a=R.hex_lollipop:t<.6&&(a=R.hex_candy),this.bossHealthBar.fillStyle(a,1);var o=200*t;this.bossHealthBar.fillRoundedRect(-100,-10,o,20,10)}}},{key:"createBossHealthUI",value:function(){this.removeBossHealthUI(),this.bossHealthBg=this.add.graphics(),this.bossHealthBg.fillStyle(R.hex_black,.7),this.bossHealthBg.fillRoundedRect(-110,-20,220,40,15),this.bossHealthBg.setDepth(15),this.bossHealthBarBg=this.add.graphics(),this.bossHealthBarBg.fillStyle(3355443,.8),this.bossHealthBarBg.fillRoundedRect(-100,-10,200,20,10),this.bossHealthBarBg.setDepth(16),this.bossHealthBar=this.add.graphics(),this.bossHealthBar.setDepth(17)}},{key:"removeBossHealthUI",value:function(){this.bossHealthBg&&(this.bossHealthBg.destroy(),this.bossHealthBg=null),this.bossHealthBarBg&&(this.bossHealthBarBg.destroy(),this.bossHealthBarBg=null),this.bossHealthBar&&(this.bossHealthBar.destroy(),this.bossHealthBar=null)}},{key:"createBossBullet",value:function(){var e=this;if(this.boss&&this.boss.active&&!this.isGameOver&&!this.isPaused){var t=[function(){for(var t=0;t<j[e.level].bossBullet;t++){var s=e.bossBullets.get(e.boss.x+30*(t-1),e.boss.y+50);s&&(s.setScale(.1),s.body.setVelocityY(300),s.body.setVelocityX(50*(t-1)))}},function(){for(var t=j[e.level].bossBullet,s=-30*Math.floor(t/2),i=0;i<t;i++){var a=Phaser.Math.DegToRad(s+30*i),o=e.bossBullets.get(e.boss.x,e.boss.y+50);o&&(o.setScale(.1),o.body.setVelocity(250*Math.sin(a),250*Math.cos(a)))}},function(){for(var t=Phaser.Math.Angle.Between(e.boss.x,e.boss.y,e.player.x,e.player.y),s=0;s<j[e.level].bossBullet;s++){var i=t+.3*(s-1),a=e.bossBullets.get(e.boss.x,e.boss.y+50);a&&(a.setScale(.1),a.body.setVelocity(250*Math.cos(i),250*Math.sin(i)))}},function(){for(var t=0;t<6;t++){var s=t/6*Math.PI*2,i=e.bossBullets.get(e.boss.x,e.boss.y+50);i&&(i.setScale(.1),i.body.setVelocity(200*Math.cos(s),200*Math.sin(s)))}},function(){for(var t=.005*Date.now(),s=0;s<4;s++){var i=s/4*Math.PI*2+t,a=e.bossBullets.get(e.boss.x,e.boss.y+50);a&&(a.setScale(.1),a.body.setVelocity(250*Math.cos(i),250*Math.sin(i)))}},function(){for(var t=0;t<4;t++){var s=t%2==0?-1:1,i=Math.floor(t/2),a=Phaser.Math.DegToRad(s*(15+10*i)),o=e.bossBullets.get(e.boss.x,e.boss.y+50);o&&(o.setScale(.1),o.body.setVelocity(300*Math.sin(a),300*Math.cos(a)))}}];t[Phaser.Math.Between(0,t.length-1)](),this.soundManager.playSound("bossShootSound")}}},{key:"defeatBoss",value:function(e){var t=this;this.bossBulletTimer&&(this.bossBulletTimer.destroy(),this.bossBulletTimer=null),this.removeBossHealthUI(),this.time.delayedCall(500,function(){t.tweens.add({targets:e,alpha:0,duration:1e3,onComplete:function(){e.destroy(),t.bossBullets.clear(!0,!0),t.sound.stopAll(),t.soundManager.setBGM("coinBgm");for(var s=0;s<20;s++){var i=Phaser.Math.Between(100,620),a=Phaser.Math.Between(200,800),o=t.coins.create(i,a,"coin");o.setScale(.3),o.setSize(.8*o.width,.8*o.height),o.play("coinAni")}for(var r=0;r<j[t.level].walkieReward;r++){var n=Phaser.Math.Between(100,620),l=Phaser.Math.Between(200,800),h=t.walkies.create(n,l,"walkie");h.setScale(.3),h.body.setSize(.8*h.width,.8*h.height)}t.time.delayedCall(5e3,function(){return t.nextLevel()})}})})}},{key:"startObstacleTimer",value:function(){this.obstacleTimer=this.time.addEvent({delay:1e3,callback:this.createObstacle,callbackScope:this,loop:!0})}},{key:"showBoss",value:function(){var e=this;this.sound.stopAll(),this.soundManager.setBGM("bossBgm"),this.boss=this.physics.add.sprite(this.scale.width/2,-100,"boss1"),this.boss.type="boss1",this.boss.body.setSize(.8*this.boss.width,.8*this.boss.height),this.boss.setScale(.4),this.boss.hitCount=0,this.createBossHealthUI(),this.tweens.add({targets:this.boss,y:250,duration:3500,ease:"Sine.easeInOut"}),this.tweens.add({targets:this.boss,x:{getStart:function(){return e.scale.width/2-120},getEnd:function(){return e.scale.width/2+120}},duration:900,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.bossBulletTimer=this.time.addEvent({delay:3e3,callback:this.createBossBullet,callbackScope:this,loop:!0}),this.physics.add.overlap(this.playerBullets,this.boss,this.playerBulletHitBoss,null,this),this.physics.add.overlap(this.player,this.boss,this.bossHitPlayer,null,this)}},{key:"showRevivePopup",value:function(){var e=this,s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isGameOver&&this.soundManager.stopAll(),this.soundManager.playSound("hitPlayerSound");var i=this.scale,a=i.width,o=i.height,r=this.player.hitCount||0,n=2*r+1,l=parseInt(this.walkieText.text),h=l>=n;this.createOverlay(45);var u=this.add.image(a/2,o/2,"revivePopup").setScale(0).setDepth(50).setAlpha(0);this.tweens.add({targets:this.overlay,fillAlpha:.7,duration:300,ease:"Power2.out"}),this.tweens.add({targets:u,scaleX:1.6,scaleY:1.6,alpha:1,duration:400,ease:"Back.out",delay:100});var c=this.add.container(a/2+20,o/2-260).setDepth(51).setAlpha(0),d=this.add.text(0,-30,s?"오답이에요!":"".concat(r+1,"번째 충돌!"),{fontSize:"32px",fill:s?R.color_lollipop:R.color_chocolate,fontFamily:"Cafe24Surround",align:"center"}).setOrigin(.5),p=this.add.image(-110,-45,"walkie").setScale(.3).setOrigin(.5);c.add([d,p]);var y=this.add.text(a/2,o/2+10,"워키토키 ".concat(n,"개를 사용해 \n긴급 수리를\n요청할 수 있어요!"),{fontSize:"26px",fill:R.color_deepBlue,fontFamily:"Cafe24Surround",align:"center",wordWrap:{width:500}}).setOrigin(.5).setDepth(51).setAlpha(0);this.tweens.add({targets:[c,y],alpha:1,duration:300,ease:"Power2.out",delay:300});var g=this.add.image(a/2-70,o/2+110,"reviveButton").setOrigin(.5).setDepth(51).setInteractive().setAlpha(0).setScale(.2),b=this.add.image(a/2+70,o/2+110,"endGameButton").setOrigin(.5).setDepth(51).setInteractive().setAlpha(0).setScale(.2);this.tweens.add({targets:[g,b],alpha:1,scaleX:.2,scaleY:.2,duration:300,ease:"Back.out",delay:500}),h?(this.soundManager.playSound("incorrectSound"),this.repairSprite=this.add.sprite(this.scale.width/2,this.scale.height/2-140,"playerRepair").setDepth(52).setScale(1),this.repairSprite.play("playerRepairAni"),t(g,this),g.on("pointerdown",function(){e.soundManager.playSound("buttonSound"),e.walkieText.setText(l-n);var t=parseInt(e.repairText.text);e.repairText.setText(t+1),e.removeOverlay(),u.destroy(),c.destroy(),y.destroy(),g.destroy(),b.destroy(),e.game.canvas.style.cursor="default",e.showQuizPopup()})):(this.soundManager.playSound("gameOverSound"),this.repairSprite&&(this.repairSprite.destroy(),this.repairSprite=null),y.setText("워키토키가 부족해\n수리가 불가능해요!"),this.add.sprite(this.scale.width/2,this.scale.height/2-140,"playerSad").setDepth(52).setScale(1).play("playerSadAni"),g.setTint(8947848)),t(b,this),b.on("pointerdown",function(){e.removeOverlay(),e.handleQuit()}),this.game.canvas.style.cursor="default"}},{key:"showQuizPopup",value:function(){var e=this;this.repairSprite&&(this.repairSprite.destroy(),this.repairSprite=null);var t=this.scale,s=t.width,i=t.height,a=this.quizData[Phaser.Math.Between(0,this.quizData.length-1)],o=this.add.image(s/2,i/2,"quizContainer").setScale(.7).setDepth(60).setAlpha(0);this.createOverlay(55),this.tweens.add({targets:this.overlay,fillAlpha:.7,duration:300,ease:"Power2.out"}),this.tweens.add({targets:o,scaleX:.8,scaleY:.8,alpha:1,duration:400,ease:"Back.out",delay:100});var r=this.add.text(s/2,i/2-70,a.question,{fontSize:"28px",fill:R.color_lollipop,fontFamily:"Cafe24Surround",align:"center",wordWrap:{width:500}}).setOrigin(.5).setDepth(61).setAlpha(0);this.tweens.add({targets:r,alpha:1,duration:300,ease:"Power2.out",delay:300});var n=[],l=s/2-160*(a.examples.length-1)/2;a.examples.forEach(function(t,s){var h=l+160*s,u=i/2+60,c=e.add.image(h,u,"quizItemBox").setOrigin(.5).setDepth(61).setInteractive().setAlpha(0).setScale(.5),d=t;if(t.length>4){for(var p=[],y=0;y<t.length;y+=4)p.push(t.substring(y,y+4));d=p.join("\n")}var g=e.add.text(h,u,d,{fontSize:"50px",fill:"#333",fontFamily:"Cafe24Surround",align:"center",lineSpacing:10}).setOrigin(.5).setDepth(62).setAlpha(0);n.push({bg:c,text:g}),c.on("pointerover",function(){c.setTint(13421772),e.game.canvas.style.cursor="pointer"}),c.on("pointerout",function(){c.clearTint(),e.game.canvas.style.cursor="default"}),c.on("pointerdown",function(){e.soundManager.playSound("buttonSound"),e.handleQuizAnswer(t,a.answer,{quizContainer:o,questionText:r,quizItemButtons:n})})}),n.forEach(function(t,s){e.tweens.add({targets:[t.bg,t.text],alpha:1,scaleX:t.bg?.5:1.5,scaleY:t.bg?.5:1.5,duration:300,ease:"Back.out",delay:500+100*s})})}},{key:"handleQuizAnswer",value:function(e,t,s){e===t?this.correctAnswer():this.incorrectAnswer(),Object.values(s).forEach(function(e){Array.isArray(e)?e.forEach(function(e){e.bg&&e.text?(e.bg.destroy(),e.text.destroy()):e.destroy&&e.destroy()}):e.destroy()}),this.game.canvas.style.cursor="default"}},{key:"correctAnswer",value:function(){var e=this;this.soundManager.playSound("correctSound");var t=this.add.sprite(this.scale.width/2,this.scale.height/2,"playerDance").setDepth(70).setScale(1.2);t.play("playerDanceAni");var s=this.add.text(this.scale.width/2,this.scale.height/2-200,"정답입니다!",{fontSize:"40px",fill:R.color_lollipop,fontFamily:"Cafe24Surround",align:"center"}).setOrigin(.5).setDepth(70);this.time.delayedCall(2e3,function(){s.destroy(),t.destroy();var i=e.player.hitCount||0;e.player.hitCount=i+1,e.player.setTexture("player"),e.isBossShown&&(e.player.y+=400),e.removeOverlay(),e.gameResume(),e.obstacleTimer||e.isBossShown||e.startObstacleTimer()})}},{key:"incorrectAnswer",value:function(){this.player.hitCount=(this.player.hitCount||0)+1,this.showRevivePopup(!0)}},{key:"nextLevel",value:function(){var e=this;this.isGameOver||this.isPaused||(this.sound.stopAll(),this.level++,this.level>10?this.showGameComplete():(this.updateLevelProgressBar(),this.isBossShown=!1,this.obstacleCount=0,this.currentObstacleType=0,this.isPaused=!1,this.isGameOver=!1,this.playerShake=0,this.obstacles.clear(!0,!0),this.coins.clear(!0,!0),this.shields.clear(!0,!0),this.doubles.clear(!0,!0),this.walkies.clear(!0,!0),this.bossBullets.clear(!0,!0),this.playerBullets.clear(!0,!0),this.player.setTexture("player"),this.player.setPosition(360,1120),this.player.setVelocity(0,0),this.player.shieldOverlay&&(this.player.shieldOverlay.destroy(),this.player.shieldOverlay=null),this.doubleTimer&&(this.doubleTimer.destroy(),this.doubleTimer=null),this.bulletTimer&&this.bulletTimer.destroy(),this.bossBulletTimer&&(this.bossBulletTimer.destroy(),this.bossBulletTimer=null),this.removeDoubleTimerUI(),this.removeBossHealthUI(),this.bulletTimer=this.time.addEvent({delay:500,callback:function(){if(!e.isGameOver){var t=e.playerBullets.get(e.player.x,e.player.y-50);t&&(t.setScale(.1),t.body.setVelocityY(-600))}},loop:!0}),this.showLevelUpNotification(),this.gamePause(),this.time.delayedCall(2e3,function(){e.gameResume(),e.soundManager.setBGM("bgm"),e.obstacleTimer||e.startObstacleTimer()})))}},{key:"showLevelUpNotification",value:function(){var e=this;this.soundManager.playSound("explosionSound");var t=this.scale,s=t.width,i=t.height,a=this.add.image(s/2,i/2,"nextContainer").setScale(0).setDepth(20).setAlpha(0),o=this.add.text(s/2,i/2+50,"Level ".concat(this.level),{fontSize:"45px",fill:R.color_lollipop,fontFamily:"Cafe24Surround",align:"center"}).setOrigin(.5).setDepth(21).setAlpha(0);this.tweens.add({targets:[a,o],scaleX:1,scaleY:1,alpha:1,duration:500,ease:"Back.out"}),this.createOverlay(19),this.tweens.add({targets:this.overlay,fillAlpha:.7,duration:300,ease:"Power2.out"}),this.time.delayedCall(2e3,function(){e.tweens.add({targets:[a,o],scaleX:0,scaleY:0,alpha:0,duration:300,ease:"Back.in",onComplete:function(){a.destroy(),o.destroy(),e.removeOverlay()}})})}},{key:"showGameComplete",value:function(){var e=this;this.soundManager.setBGM("finalSound");var s=this.scale,i=s.width,a=s.height,o=this.add.image(this.scale.width/2,this.scale.height/2,"finishBackground").setDepth(80).setAlpha(0),r=this.add.text(i/2,a/2+60,"최종 점수: ".concat(this.score),{fontSize:"36px",fill:R.color_chocolate,fontFamily:"Cafe24Surround",align:"center",padding:{x:20,y:10}}).setOrigin(.5).setDepth(81).setAlpha(0),n=this.add.image(i/2,a-80,"goHomeButton").setOrigin(.5).setDepth(81).setInteractive().setAlpha(0).setScale(.3);t(n,this),this.tweens.add({targets:[o,r,n],alpha:1,duration:500,ease:"Power2.out",delay:200}),n.on("pointerdown",function(){return e.handleQuit()})}},{key:"handleQuit",value:function(){this.soundManager.playSound("buttonSound"),this.obstacleTimer&&(this.obstacleTimer.destroy(),this.obstacleTimer=null),this.bulletTimer&&(this.bulletTimer.destroy(),this.bulletTimer=null),this.doubleTimer&&(this.doubleTimer.destroy(),this.doubleTimer=null),this.bossBulletTimer&&(this.bossBulletTimer.destroy(),this.bossBulletTimer=null),this.scene.stop("GameScene"),this.scene.start("MenuScene"),this.game.canvas.style.cursor="default",this.isPaused=!1,this.isGameOver=!1,this.isBossShown=!1,this.obstacleCount=0,this.currentObstacleType=0,this.distance=0,this.score=0,this.level=1}}],i&&v(s.prototype,i),Object.defineProperty(s,"prototype",{writable:!1}),s;var s,i,a,o}();function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function O(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,P(i.key),i)}}function P(e){var t=function(e){if("object"!=k(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var s=t.call(e,"string");if("object"!=k(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==k(t)?t:t+""}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(D=function(){return!!e})()}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}function H(e,t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H(e,t)}var C=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,s){return t=M(t),function(e,t){if(t&&("object"==k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,D()?Reflect.construct(t,s||[],M(e).constructor):t.apply(e,s))}(this,e,["Boot"])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(e,Phaser.Scene),t=e,(s=[{key:"preload",value:function(){this.load.image("logo","assets/images/icecandy_logo.png")}},{key:"create",value:function(){var e=this,t=this.scale,s=t.width,i=t.height,a=this.add.rectangle(0,0,s,i,13234170).setOrigin(0,0),o=this.add.image(s/2,i/2,"logo").setAlpha(0);o.setY(o.y+100),this.tweens.add({targets:o,alpha:1,y:"-=120",duration:150,ease:"ease-in-out",repeat:0,onComplete:function(){return e.tweens.add({targets:o,alpha:1,y:"+=20",duration:100,ease:"ease-in-out",repeat:0})}}),this.time.delayedCall(1200,function(){return e.tweens.add({targets:[o,a],alpha:0,duration:200,ease:"ease-in-out",repeat:0})}),this.time.delayedCall(1500,function(){return e.scene.start("MenuScene")})}}])&&O(t.prototype,s),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,s}(),A={type:Phaser.AUTO,width:720,height:1280,parent:"game-container",physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1,timeScale:1,fps:60}},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[C,y,x]},R={color_chocolate:"#6F412B",color_lollipop:"#FF6F91",color_ice:"#75D4E8",color_deepBlue:"#1A374D",color_candy:"#F9DD52",color_mint:"#A8E6CF",color_greenTea:"#748F1B",color_snow:"#FFFFFF",color_black:"#000000",hex_chocolate:7291179,hex_lollipop:16740241,hex_ice:7722216,hex_deepBlue:1718093,hex_candy:16375122,hex_mint:11069135,hex_greenTea:7638811,hex_snow:16777215,hex_black:0},j={1:{bossDistance:3e3,bossBullet:3,bossHit:20,obstacleCount:1,walkieReward:1},2:{bossDistance:6e3,bossBullet:3,bossHit:25,obstacleCount:1,walkieReward:3},3:{bossDistance:9e3,bossBullet:3,bossHit:30,obstacleCount:1,walkieReward:5},4:{bossDistance:12e3,bossBullet:5,bossHit:35,obstacleCount:2,walkieReward:7},5:{bossDistance:15e3,bossBullet:5,bossHit:40,obstacleCount:2,walkieReward:9},6:{bossDistance:18e3,bossBullet:5,bossHit:45,obstacleCount:2,walkieReward:11},7:{bossDistance:21e3,bossBullet:7,bossHit:50,obstacleCount:3,walkieReward:13},8:{bossDistance:24e3,bossBullet:7,bossHit:55,obstacleCount:3,walkieReward:15},9:{bossDistance:27e3,bossBullet:7,bossHit:60,obstacleCount:3,walkieReward:17},10:{bossDistance:3e4,bossBullet:7,bossHit:65,obstacleCount:3,walkieReward:19}};new Phaser.Game(Object.assign(A,R,j)).scene.start("Boot",{colors:R,levels:j})})();